apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: gpu-operator

resources:
  - namespace.yaml
  - time-slicing-config.yaml
  - cluster-policy.yaml

helmCharts:
  - name: gpu-operator
    repo: https://helm.ngc.nvidia.com/nvidia
    version: v23.9.1  # Check for the latest version
    releaseName: gpu-operator
    namespace: gpu-operator
    includeCRDs: true
    valuesInline:
      driver:
        enabled: false  # Disable driver installation since Pop!_OS has pre-installed drivers
      toolkit:
        enabled: true
      devicePlugin:
        enabled: true
        config:
          name: time-slicing-config
          default: config.yaml
      migManager:
        enabled: false  # Enable if you need MIG support
      gfd:  # GPU Feature Discovery
        enabled: true